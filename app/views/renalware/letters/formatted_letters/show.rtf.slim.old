ruby:
  styles = {}

  document_style = RTF::DocumentStyle.new.tap do |style|
    style.left_margin = style.right_margin = 1000
    style.top_margin = style.bottom_margin = 800
  end

  styles[:bold] = RTF::CharacterStyle.new.tap do |style|
    style.bold = true
  end

  styles[:left_align] = RTF::ParagraphStyle.new.tap do |style|
    style.space_before   = 100
    style.space_after    = 100
    style.justification = RTF::ParagraphStyle::RIGHT_JUSTIFY
  end

  font = RTF::Font.new(RTF::Font::ROMAN, "Arial")
  # document.font(font, 11) << "smaller text"

  document = RTF::Document.new(font, document_style)

    document.paragraph(styles[:left_align]) do |p|
      p << raw(letter.letterhead.trust_name)
      p.line_break
      p << letter.letterhead.trust_caption
    end

    document.paragraph << letter.letterhead.unit_info
    document.line_break
    document.paragraph << l(letter.issued_on)
    document.paragraph(styles[:bold]) << letter.description
    document.paragraph << letter.event_description
    document.paragraph << "PRIVATE AND CONFIDENTIAL"
    document.line_break
    letter.main_recipient.address.to_a.each do |part|
      document.paragraph << part
    end

    site_infos = letter.letterhead.site_info.gsub("<p>", "").gsub("</p>", "").split("<br>")
    byebug
    #document.paragraph <<
    # document.paragraph << raw(letter.letterhead.site_info)
    # #document.paragraph << render("patient_summary", patient: letter.patient)
    # document.paragraph << render(letter.parts)
    # document.paragraph << letter.body
    # document.paragraph << ""
    # document.paragraph << ""
    # document.paragraph << ""
    # document.paragraph << letter.signature
    # document.paragraph << letter.author.signature

    # document.paragraph << "cc:"
    # document.paragraph << "Private and confidential"

    # letter.cc_recipients.each do |cc|
    #   document.paragraph << cc.to_s
    # end

= document.to_rtf


